"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[52406],{452406:(e,i,t)=>{t.d(i,{Z:()=>y});var l=t(667294),o=t(545007),s=t(616550),a=t(883119),r=t(488792),n=t(636565),d=t(758339),c=t(144326),h=t(297728),_=t(410150),u=t(26456),p=t(451237),m=t(785893);function P({isOpen:e,onDismiss:i}){let t=(0,c.ZP)();return(0,m.jsx)(d.ZP,{accessibilityModalLabel:t._('Disabled Pin Publishing Error Message Modal', 'disabledPinCreationModal.modal.accessibilityLabel', 'Label for disabled pin creation modal'),isOpen:e,mobileAccessibilityCloseIconLabel:t._('Close disabled publishing message modal', 'disabledPinCreationModal.modal.closeIconLabel', 'Label for the close button on the disabled publishing modal'),onDismiss:i,type:"DisabledPublishingModal",children:(0,m.jsxs)(a.xu,{alignItems:"center",direction:"column",display:"flex",paddingX:6,paddingY:4,children:[(0,m.jsx)(a.X6,{children:t._('Oops...', 'disabledPinCreationModal.modal.heading', 'Exclamation used to show recognition of a mistake.')}),(0,m.jsx)(a.xu,{paddingY:3,children:(0,m.jsx)(a.xv,{children:t._('Our server is experiencing a mild case of the hiccups at the moment. Please try refreshing and publishing again later.', 'disabledPinCreationModal.modal.text', 'Message to let users know there is an error.')})}),(0,m.jsx)(a.xu,{paddingY:3,children:(0,m.jsx)(a.zx,{color:"red",onClick:()=>i(),size:"lg",text:t._('Dismiss', 'disabledPinCreationModal.button.dismiss', 'Button text for closing the disabled pin creation modal')})})]})})}function b(e){let i=(0,c.ZP)(),{viewType:t,boardId:l,handleTouch:o}=e,s=i._('Board', 'createMenuLinkButton.Create.Board.Label', 'label for creating a new board option'),r=i._('Section', 'createMenuLinkButton.Create.Section.Label', 'label for creating a new section option');return 5===t&&l?(0,m.jsx)(a.Tg,{href:`/board/${l}/create_section/`,onTap:o,rounding:2,children:(0,m.jsx)(a.xu,{"data-test-id":"addSectionButton",paddingY:2,children:(0,m.jsx)(a.X6,{size:"400",children:r})})}):(0,m.jsx)(a.Tg,{href:"/board/create/",onTap:o,children:(0,m.jsx)(a.xu,{"data-test-id":"createMenuCreateBoardButton",paddingY:2,children:(0,m.jsx)(a.X6,{size:"400",children:s})})})}var g=t(246826);function f({disabledPinCreation:e,handleDisablePublish:i,handleTouch:t}){let l=(0,c.ZP)(),o=(0,s.k6)(),r=e=>({imageBase64:e,description:"",imageUrl:"",method:g.Iv}),n=l._('Photo', 'createPinButton.Photo.Upload.Label', 'label to upload pin from camera roll photos');return(0,m.jsx)(a.iP,{onTap:()=>{if(e){i();return}t()},tapStyle:"none",children:(0,m.jsxs)(a.xu,{paddingY:2,position:"relative",children:[(0,m.jsx)(a.X6,{size:"400",children:n}),e?null:(0,m.jsx)("input",{accept:"image/*",id:"upload-pin",onChange:e=>{let i=new FileReader;i.readAsDataURL(e.target.files[0]),i.onload=()=>{let e=i.result;o.push({pathname:`/pin/create/${g.Iv}/`,state:r(String(e))})}},style:{opacity:0,position:"absolute",top:"0px",height:"100%",width:"100%"},type:"file"})]})})}var x=t(947506),A=t(934648),z=t(799239);function L(e,i,t){var l;return(i="symbol"==typeof(l=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var l=t.call(e,i||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?l:l+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let C=new a.Ry(1),j=e=>{let i=window&&window.innerWidth||0,t=e._('Enter a link to create a Pin, https://...', 'placeholder in text field where a user inputs a URL to create a Pin', 'placeholder in text field where a user inputs a URL to create a Pin'),l=e._('Enter a link, https://...', 'placeholder in text field where a user inputs a URL to create a Pin - short version, 30 char limit', 'placeholder in text field where a user inputs a URL to create a Pin - short version, 30 char limit');return i<380?l:t};class w extends l.PureComponent{constructor(...e){super(...e),L(this,"state",{createPinFromLinkUrl:"",showCreateModal:!1,showInlineTextEditCreatePin:!1,showPublishingDisabledError:!1,urlValidationError:null}),L(this,"createPinFromLinkInput",(0,l.createRef)()),L(this,"createMenuPlusIconButtonRef",(0,l.createRef)()),L(this,"closeCreateModal",()=>{this.setState({showCreateModal:!1,showInlineTextEditCreatePin:!1}),this.props.updatePinBuilderInput({isInputOpen:!1,submittedLink:""})}),L(this,"clearValidationError",()=>{this.setState({urlValidationError:null})}),L(this,"openCreateModal",()=>{this.handleTouch(),this.props.requireAuthForLimitedLogin({fn:()=>this.setState({showCreateModal:!0}),modalHeader:(0,x.is)(this.props.i18n)})()}),L(this,"handleCreatePinFromLinkTouch",()=>{this.setState({showInlineTextEditCreatePin:!0}),this.props.updatePinBuilderInput({isInputOpen:!0})}),L(this,"handleDisablePublish",()=>{this.setState({showCreateModal:!1,showPublishingDisabledError:!0})}),L(this,"handleLinkFieldChange",({value:e})=>{this.setState({createPinFromLinkUrl:e})}),L(this,"handlePinFromLinkFormSubmit",(e,i)=>{let{createPinFromLinkUrl:t}=this.state,{experimentsClient:l}=this.props;e.preventDefault();let{errors:o}=(0,u.Jx)({message:this.props.i18n._('Oops! Please enter a valid URL.', 'URL validation error message on Pin builder form', 'URL validation error message on Pin builder form'),experimentsClient:l})(t),[s]=o;s?this.setState({urlValidationError:s}):this.handleUrlValidationSuccess(i)}),L(this,"handleTouch",()=>{let{logContextEvent:e,viewType:i,elementType:t}=this.props;e({view_type:i,view_parameter:3106,element:t,event_type:102,aux_data:{source:p.Z.PROFILE}})}),L(this,"handleUrlValidationSuccess",e=>{this.setState({showInlineTextEditCreatePin:!1});let{createPinFromLinkUrl:i}=this.state;this.props.updatePinBuilderInput({submittedLink:i}),e.push({pathname:"/pin-builder/",state:{createPinFromLinkUrl:i}}),this.closeCreateModal()}),L(this,"renderCreatePinFromLinkOption",()=>{let{disabledPinCreation:e,history:i}=this.props,{createPinFromLinkUrl:t,showInlineTextEditCreatePin:l}=this.state,o=this.props.i18n._('Website', 'editPin.CreatePinFromUrl.Label', 'label for option to create a pin from a url');return(0,m.jsx)(a.kC,{alignItems:"center",height:46,justifyContent:"start",children:l?(0,m.jsx)("form",{onSubmit:e=>this.handlePinFromLinkFormSubmit(e,i),style:{width:"100%"},children:(0,m.jsxs)(a.xu,{display:"flex",justifyContent:"between",position:"relative",zIndex:C,children:[(0,m.jsxs)(a.xu,{ref:this.createPinFromLinkInput,width:"100%",children:[this.renderErrorFlyout(),(0,m.jsx)(a.nv,{id:"create-pin-from-link",onChange:this.handleLinkFieldChange,onFocus:()=>this.setState({urlValidationError:null}),placeholder:j(this.props.i18n),size:"lg",value:t})]}),(0,m.jsx)(a.hU,{accessibilityLabel:this.props.i18n._('Create Pin from entered link', 'navigation button to confirm user will create a Pin from a link they entered', 'navigation button to confirm user will create a Pin from a link they entered'),icon:"arrow-forward",iconColor:"darkGray",onClick:({event:e})=>this.handlePinFromLinkFormSubmit(e,i),size:"lg"})]})}):(0,m.jsx)(a.iP,{onTap:()=>{if(e){this.handleDisablePublish();return}this.handleCreatePinFromLinkTouch()},tapStyle:"none",children:(0,m.jsx)(a.xu,{"data-test-id":"websiteButton",position:"relative",children:(0,m.jsx)(a.X6,{size:"400",children:o})})})})}),L(this,"renderErrorFlyout",()=>{let{urlValidationError:e}=this.state;return e&&(0,m.jsx)(a.J2,{anchor:this.createPinFromLinkInput.current,idealDirection:"up",onDismiss:this.clearValidationError,size:"sm",children:(0,m.jsx)(a.xu,{padding:3,width:"100%",children:(0,m.jsxs)(a.kC,{gap:2,children:[(0,m.jsx)(a.qb,{type:"problem"}),(0,m.jsx)(a.xv,{align:"center",weight:"bold",children:e})]})})})})}componentDidMount(){let{isInputOpen:e,submittedLink:i}=this.props;(e||i)&&this.setState({showCreateModal:!!e,showInlineTextEditCreatePin:!!e,createPinFromLinkUrl:i||""})}render(){let{bgColor:e,boardId:i,buttonPadding:t,disabledPinCreation:o,i18n:s,isDesktop:r,iconButtonColor:c="gray",iconButtonSize:h="xl",viewType:_}=this.props,{showCreateModal:u,showPublishingDisabledError:p}=this.state,g=this.props.i18n._('Add a Pin or board', 'heading in profile create modal', 'heading in profile create modal');164===_?g=this.props.i18n._('Add to section', 'heading in section create modal', 'heading in section create modal'):5===_&&(g=this.props.i18n._('Add a Pin or section', 'heading in profile create modal', 'heading in profile create modal')||s._('Add to board', 'heading in board create modal', 'heading in board create modal'));let x=4===_?this.props.i18n._('Add to profile', 'editPin.AddToProfile.Modal.Header', 'heading in profile create modal'):g,A=(5===_||164===_)&&this.createMenuPlusIconButtonRef.current;return(0,m.jsxs)(l.Fragment,{children:[(0,m.jsx)(a.kC,{alignItems:"center",justifyContent:"start",children:(0,m.jsx)(a.xu,{"data-test-id":"createMenuCreateButton",children:(0,m.jsx)(a.hU,{ref:this.createMenuPlusIconButtonRef,accessibilityLabel:this.props.i18n._('Create a Pin or board', 'icon that opens model prompting user to create a new pin or board', 'icon that opens model prompting user to create a new pin or board'),bgColor:e,icon:"add",iconColor:c,onClick:this.openCreateModal,padding:"auto"!==t?t:1,size:h})})}),u&&(0,m.jsx)(d.ZP,{accessibilityModalLabel:"",heading:x,isOpen:this.state.showCreateModal,mobileAccessibilityCloseIconLabel:this.props.i18n._('close board and pin create modal', 'close modal that prompts user to create a new pin or board', 'close modal that prompts user to create a new pin or board'),onDismiss:this.closeCreateModal,type:"create_menu",children:(0,m.jsx)(a.xu,{padding:3,children:(0,m.jsxs)(a.kC,{alignItems:"stretch",direction:"column",justifyContent:"start",children:[(0,m.jsxs)(l.Fragment,{children:[(0,m.jsxs)(a.xu,{paddingX:2,children:[(0,m.jsx)(a.xv,{children:this.props.i18n._('Create', 'editPin.Create.Section.Text', 'Section title to Create new things on Edit Pin add modal')}),(0,m.jsx)(l.Fragment,{children:this.renderCreatePinFromLinkOption()}),(0,m.jsx)(f,{disabledPinCreation:o,handleDisablePublish:this.handleDisablePublish,handleTouch:this.handleTouch})]}),164!==_&&(0,m.jsxs)(a.xu,{marginTop:6,paddingX:2,children:[(0,m.jsx)(a.xv,{children:this.props.i18n._('Add', 'editPin.Section.Add.Text', 'Section Add title on Edit Pin add modal')}),(0,m.jsx)(b,{boardId:i,handleTouch:()=>{this.handleTouch(),this.closeCreateModal()},viewType:_})]})]}),(0,m.jsx)(a.xu,{display:"flex",justifyContent:"center",marginBottom:2,marginTop:7,children:(0,m.jsx)(a.zx,{onClick:()=>this.closeCreateModal(),size:"lg",text:this.props.i18n._('Close', 'editPin.Modal.Close.Button', 'Button text to close modal on EditPin')})})]})})}),p&&(0,m.jsx)(P,{isOpen:!0,onDismiss:()=>{this.setState({showPublishingDisabledError:!1})}}),A&&(0,m.jsx)(n.N,{anchors:{[r?3006:4006]:this.createMenuPlusIconButtonRef.current},idealDirection:"up",onAnchorTouch:"complete",placementId:r?18:1000251,scrollToDismiss:!0})]})}}function y(e){let i=(0,c.ZP)(),t=(0,_.HG)(),l=(0,h.F)(),{checkExperiment:a}=l,n=["disable_all","disable_web_pins"].includes(a("disable_pin_creation").group),d=(0,o.I0)(),u=(0,s.k6)(),{pinBuilder:p}=(0,o.v9)(e=>e.session),P=(0,r.Z)(),b=p&&p.isInputOpen,g=p&&p.submittedLink,f=(0,A.Z)();return(0,m.jsx)(w,{...e,disabledPinCreation:n,experimentsClient:l,history:u,i18n:i,isDesktop:t,isInputOpen:b,logContextEvent:P,requireAuthForLimitedLogin:f,submittedLink:g,updatePinBuilderInput:e=>d((0,z.p)(e))})}},246826:(e,i,t)=>{t.d(i,{Iv:()=>l,dU:()=>_,it:()=>a,jI:()=>h,n0:()=>n,nY:()=>s,sW:()=>c,up:()=>o});let l="uploaded",o="pinbuilder",s="scraped",a="button";function r(e){return!!e&&"object"==typeof e&&"method"in e}function n(e){return r(e)&&e.method===s}function d(e){return r(e)&&e.method===l}function c(e){return r(e)&&e.method===a}function h(e){return n(e)||d(e)||c(e)}function _({boardId:e,checkExperiment:i,createPin:t,sectionId:l,state:o}){let s=[];if(n(o)){let{imgData:a}=o;a.forEach(a=>{s.push(t(function({boardId:e,checkExperiment:i,image:t,sectionId:l,state:o}){let{description:s,link:a,method:r}=o;return{boardId:e,checkExperiment:i,description:s,guid:"",imageBase64:"",imageUrl:t,link:a,method:r,sectionId:l}}({boardId:e,checkExperiment:i,image:a,sectionId:l,state:o})))})}else s.push(t(function({boardId:e,checkExperiment:i,sectionId:t,state:l}){if(d(l)){let{description:o,imageBase64:s,imageUrl:a,method:r}=l;return{boardId:e,checkExperiment:i,description:o,guid:"",imageBase64:s,imageUrl:a,link:"",method:r,sectionId:t}}{let{description:o,guid:s,imageUrl:a,link:r,method:n}=l;return{boardId:e,checkExperiment:i,description:o,guid:s,imageUrl:a,link:r,method:n,sectionId:t}}}({boardId:e,checkExperiment:i,sectionId:l,state:o})));return s}},947506:(e,i,t)=>{t.d(i,{Bb:()=>m,Bx:()=>r,F4:()=>a,Qj:()=>n,_6:()=>p,gv:()=>s,hg:()=>d,is:()=>_,jP:()=>u,lt:()=>o,oM:()=>c,wI:()=>h});var l=t(868808);let o=e=>e._('Log in to continue', 'limitedLogin.modalHeader.default', 'Default title on mobile web limited login modal'),s=({firstName:e,i18n:i})=>e?(i._('{{ name }} invited you to join their board', 'limitedLogin.modalHeader.groupBoardCollab', 'Mobile Modal prompting users to join a friends({{ name }}) board')).replace("{{ name }}",e):i._('Your friends invited you to join their board', 'limitedLogin.modalHeader.groupBoardCollab', 'Mobile Modal prompting users to join a friends board'),a=e=>{let i=(0,l.mB)(e.search).board_url;if(i){let e=(0,l.Jx)(i),t=(0,l.XP)({accept_invite:!0,seamless:!0});return e.includes("?")?`${e}&${t}`:`${e}?${t}`}return e.pathname},r=e=>e._('Log in to save this Pin', 'limitedLogin.modalHeader.repin', 'Title on mobile web limited login modal to prompt users to login after they clicked save button.'),n=e=>{let i=e.pathname;if(i.startsWith("/pin/")){let e=i.split("/");if(e.length>2)return`/${e[1]}/${e[2]}/repin/`}return i},d=e=>e._('Log in to send this Pin', 'limitedLogin.modalHeader.send', 'Title on mobile web limited login modal to prompt users to login after they clicked send button.'),c=e=>e._('Log in to edit this Pin', 'limitedLogin.modalHeader.editPin', 'Title on mobile web limited login modal to prompt users to login after they clicked edit button.'),h=e=>{let i=e.pathname;if(i.startsWith("/pin/")){let e=i.split("/");if(e.length>2)return`/${e[1]}/${e[2]}/edit/`}return i},_=e=>e._('Log in to create a Pin or board', 'limitedLogin.modalHeader.create', 'Title on mobile web limited login modal to prompt users to login to create a Pin or board.'),u=e=>e._('Log in to hide this Pin', 'limitedLogin.modalHeader.hidePin', 'Title on mobile web limited login modal to prompt users to login after they clicked hide Pin button.'),p=e=>e._('Log in to share the profile', 'limitedLogin.modalHeader.shareProfile', 'Title on mobile web limited login modal to prompt users to login after they clicked share button on profile page.'),m=e=>e._('Log in to create a board', 'limitedLogin.modalHeader.createBoard', 'Title on mobile web limited login modal to prompt users to login to create a board.')},799239:(e,i,t)=>{t.d(i,{F:()=>l,p:()=>o});let l=e=>({type:"PIN_BUILDER_LOADED_IMAGES",payload:e}),o=e=>({type:"UPDATE_PIN_BUILDER_INPUT",payload:e})}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/52406-11b906036ee17d7c.mjs.map